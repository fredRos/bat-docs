<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>BAT manual: Bayesian Statistics</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
    TeX: {
        Macros: {
            cond: ["{\\,|\\,}"],
            rmdx: ["{\\mbox{d}#1\\,}",1],
            scath: ["{\\theta}"],
            vecth: ["{\\boldsymbol{\\theta}}"],
            order: ["{\\mathcal{O}(#1)}",1],
        }
    }
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">BAT manual 1.0.0-RC2</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li class="current"><a href="pages.html"><span>Chapters</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Bayesian Statistics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sec-basic-terminology">Basic terminology</a><ul><li class="level2"><a href="#sec-marginalization">Marginalization</a></li>
<li class="level2"><a href="#sec-model-comparison">Model comparison</a></li>
</ul>
</li>
<li class="level1"><a href="#sec-goodness-fit">Goodness of fit</a></li>
<li class="level1"><a href="#sec-representation-bat">Representation in BAT</a></li>
</ul>
</div>
<div class="textblock"><p>In this chapter, we give a concise and necessarily incomplete overview of Bayesian statistics. Our intention is to cover the bare minimum and introduce those quantities that appear in BAT. As a toolkit, BAT allows the user complete freedom in modeling. There is vast literature on the theory, applications, and modeling; for example, consider <a class="el" href="citelist.html#CITEREF_jaynes_probability_2003">[7]</a> <a class="el" href="citelist.html#CITEREF_hartigan_bayes_1983">[6]</a> <a class="el" href="citelist.html#CITEREF_sivia_data_2006">[12]</a> <a class="el" href="citelist.html#CITEREF_mackay_information_2003">[9]</a> <a class="el" href="citelist.html#CITEREF_dagostini_bayesian_2003">[2]</a> <a class="el" href="citelist.html#CITEREF_kendall_kendalls_2004">[8]</a> <a class="el" href="citelist.html#CITEREF_gelman2014bayesian">[4]</a> for a comprehensive overview.</p>
<h1><a class="anchor" id="sec-basic-terminology"></a>
Basic terminology</h1>
<p>Bayesian statistics is a framework for quantitative inductive or plausible reasoning; i.e., the optimal processing of incomplete information. The basic idea is to associate a degree of belief to logical propositions; e.g., the mass of the Higgs boson is 125 GeV. From fundamental axioms about reasoning, one can then show that the calculus of degree of belief is simply the ordinary calculus of probability theory; see <a class="el" href="citelist.html#CITEREF_jaynes_probability_2003">[7]</a> for a thorough discussion. Deductive reasoning is included as the limiting case in which the degree of belief is either 0 or 1.</p>
<p>From now on, we will use the symbol \(P(A)\) to denote both the <em>degree of belief</em> in proposition \(A\) and the <em>probability</em> of \(A\). In our applications below, \(A\) is often one value out of a continuum, so we use \(P(A)\) also to denote the <em>probability density</em> of \(A\). The <em>conditional probability</em> of \(A\) given \(B\) is \(P(A \cond B)\).</p>
<p>The two central tasks of the natural sciences are to learn about nature from data and to make predictions for (future) experiments. A <em>model</em> \(M\) is a proxy for all discrete pieces of information relevant to calculating the degree of belief. The model can contain <em>parameters</em> \(\vecth\) that take on values in a continuum, perhaps subject to constraints as for example \(\scath_1 \geq 0\). Bayesian reasoning provides an update rule to adjust the degree of belief based on new information available in the form of <em>observed data</em> \(D\). This update rule is the celebrated <em>Bayes' theorem</em> </p><p class="formulaDsp">
\begin{align} \label{eq:bayes-thm} \boxed{ P(\vecth \cond D, M) \propto P(D|\vecth, M) P(\vecth \cond M)} \end{align}
</p>
<p> \(P(\vecth \cond M)\) is the <em>prior density</em>, \(P(D|\vecth, M)\) is called the <em>probability of the data</em> when treated as a function of \(D\), and known as the <em>likelihood</em> when considering the dependence on \(\vecth\), for fixed \(D\). The model-dependent normalization constant is known as the <em>evidence</em> or <em>marginal likelihood</em>: </p><p class="formulaDsp">
\begin{equation} \label{eq:evidence} Z = \int \rmdx{ \vecth} P(D|\vecth, M) P(\vecth \cond M). \end{equation}
</p>
<p> Finally, the left-hand side \(P(\vecth | D, M)\) is the <em>posterior density</em>. Prior and posterior (<em>density</em> is usually omitted) represent the state of knowledge about the parameter \(\vecth\) before and after seeing the data. Note that \(\vecth\) appears on opposite sides of <code>|</code> in \(P(D|\vecth,M)\) and \(P(\vecth|D,M)\). That's why Bayes' theorem is also known as the theorem of <em>inverse probability</em>.</p>
<h2><a class="anchor" id="sec-marginalization"></a>
Marginalization</h2>
<p>Suppose there are two parameters, \(\vecth = (\scath_1, \scath_2)\), and \(\scath_1\) is the <em>parameter of interest</em> whereas \(\scath_2\) is a <em>nuisance parameter</em>. In Bayes' theorem, there is no fundamental distinction between parameters of interest and nuisance parameter, they are all just parameters. But often the goal of the analysis is to extract the posterior of \(\scath_1\) while \(\scath_2\) is only needed at an intermediate stage; for example in order to correctly model the measurement process of \(D\). From the joint posterior \(P(\scath_1, \scath_2 | D)\), we compute the <em>marginalized</em> posterior and can remove the dependence on \(\scath_2\) by integration </p><p class="formulaDsp">
\begin{align} \label{eq:marginal} P(\scath_1 | D) = \int \rmdx{\scath_2} P(\scath_1, \scath_2 | D). \end{align}
</p>
<h2><a class="anchor" id="sec-model-comparison"></a>
Model comparison</h2>
<p>If there is only a single model under consideration, and no potential for cconfusion, the model label \(M\) is implied and usually omitted from the equations. But suppose that there are two competing models, \(M_1, M_2\), with parameters \(\scath_{1,2}\), that quantitatively predict the outcome \(D\) of an experiment. The task is to find the model with the higher degree of belief. Using Bayes' theorem, the <em>posterior odds</em> of the models are easily found as </p><p class="formulaDsp">
\begin{equation} \label{eq:post-odds} \frac{P(M_1|D)}{P(M_2|D)} = B_{12} \cdot \frac{P(M_1)}{P(M_2)}, \end{equation}
</p>
<p> where the <em>Bayes factor</em> of \(M_1\) versus \(M_2\), \(B_{12}\), is just the ratio of the evidences </p><p class="formulaDsp">
\begin{equation} \label{eq:Bayes-factor} B_{12}= \dfrac{P(D|M_1)}{P(D|M_2)} = \frac{Z_1}{Z_2} = \frac{\int \rmdx{\vecth_1} P(D|\vecth_1, M_1) P(\vecth_1, M_1)} {\int \rmdx{ \vecth_2} P(D|\vecth_2, M_2) P(\vecth_2, M_2)} \end{equation}
</p>
<p> The <em>prior odds</em> \(P(M_1)/P(M_2)\) represent the relative degree of belief in the models, independent of the data. % The data are accounted for in the Bayes factor. The Bayes factor quantifies the relative shift of degree of belief induced by the data. In general, \(\dim \vecth_1 \ne \dim \vecth_2\), and without loss of generality let \(\dim \vecth_1 &lt; \dim \vecth_2\). The Bayes factor automatically penalizes \(M_2\) for its larger complexity, as the prior mass is spread out over a higher-dimensional volume. However, this can be compensated if the likelihood \(P(D|\vecth_2, M_2)\) is significantly higher in regions of reasonably high prior density; i.e. the Bayes factor implements Occam's razor the simplest model that describes the observations is preferred.</p>
<h1><a class="anchor" id="sec-goodness-fit"></a>
Goodness of fit</h1>
<p>In the Bayesian approach, there is, however, no straightforward answer to the following question: if there is only one model at hand, how to decide if that model is sufficient to explain the data, or if the search for a better model needs to continue? The standard procedure to tackle this problem of evaluating the <em>goodness of fit</em> is to define a test statistic \(T=T(D)\) and to evaluate the following tail-area probability, that is the \(p\) value </p><p class="formulaDsp">
\begin{align} \label{eq:pvalue} p \equiv \int_{T&gt;T_{obs}} \rmdx{T} P(T|M). \end{align}
</p>
<p> Care has to be taken in the usage, computation, and interpretation of \(p\) values. An introduction a Bayesian interpretation of \(p\) values with applications in BAT is available at <a class="el" href="citelist.html#CITEREF_Beaujean:2011zz">[1]</a> ; see also the references therein.</p>
<h1><a class="anchor" id="sec-representation-bat"></a>
Representation in BAT</h1>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd><p class="startdd">perhaps move this or remove this, let's not repeat ourselves </p>
<p class="enddd">Better just have a table of links likelihood -&gt; <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html#a5c6c0a720647ca1cb3b0a13fa6b15505">BCModel::LogLikelihood</a> etc.</p>
</dd></dl>
<p>In BAT, a model \(M\) is represented as a C++ subclass of <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html">BCModel</a>. The crucial parts are to define the likelihood \(P(D \cond \vecth, M)\) <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html#a5c6c0a720647ca1cb3b0a13fa6b15505">BCModel::LogLikelihood</a>, the prior \(P(\vecth \cond M)\) <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html#a1b4a771c494814552084705771be53eb">BCModel::LogAPrioriProbability</a>, and the parameters \(\vecth\). From these quantities, BAT can compute the unnormalized posterior \(P(\vecth \cond D, M)\) <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html#a93ec0625534f0461724870435849696e">BCModel::LogProbabilityNN</a>. To avoid numerical overflow, BAT operates on the log scale whenever possible. The key methods of <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html">BCModel</a> that a user has to implement are </p><div class="fragment"><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">double</span> LogLikelihood(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; params)</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">double</span> LogAPrioriProbability(<span class="keyword">const</span> std::vector&lt;double&gt;&amp; params)</div></div><!-- fragment --><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>BCEngine link works but <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html">BCModel</a> method not found. Why? <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCEngineMCMC.html#a673f41ff4c667f81acdf7936173e3818">BCEngineMCMC::SetNIterationsPreRunMax</a></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html#a1b4a771c494814552084705771be53eb">BCModel::LogAPrioriProbability</a> <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html#a5c6c0a720647ca1cb3b0a13fa6b15505">BCModel::LogLikelihood</a> <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCModel.html#a93ec0625534f0461724870435849696e">BCModel::LogProbabilityNN</a></dd></dl>
<p>The parameter values are passed in simply as numbers to likelihood and prior, all parameters are assumed to be real and continuous. Discrete parameters are not supported. The support of \(\vecth\) is a hyperrectangle whose bounds are given by the bounds of the individual parameters when added to the model with <a class="elRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCEngineMCMC.html#a2e33a6b426092126b408c69c4a9bce22">BCModel::AddParameter</a> </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="codeRef" doxygen="/root/bat/doc/ref-guide/bat-ref.tag:../../ref-guide/html/" href="../../ref-guide/html/classBCEngineMCMC.html#a2e33a6b426092126b408c69c4a9bce22">BCModel::AddParameter</a>(<span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">double</span> min, <span class="keywordtype">double</span> max,</div><div class="line">                           <span class="keyword">const</span> std::string&amp; latexname = <span class="stringliteral">&quot;&quot;</span>,</div><div class="line">                           <span class="keyword">const</span> std::string&amp; unitstring = <span class="stringliteral">&quot;&quot;</span>)</div></div><!-- fragment --><p> The optional <code>latexname</code> and <code>unitstring</code> are used only for labeling plot axes; it's intended usage is to pretty up plots. For example, a parameter <code>theta</code> representing a time measured in seconds is defined as </p><div class="fragment"><div class="line">AddParameter(<span class="stringliteral">&quot;theta&quot;</span>, 0, 1, <span class="stringliteral">&quot;#theta&quot;</span>, <span class="stringliteral">&quot;[s]&quot;</span>);</div></div><!-- fragment --><p> and whenever <code>theta</code> appears on the axis of a plot, it will appear as \(\theta\) [s]. Note that the plots are created with ROOT, so the <code>latexname</code> has to be in ROOT syntax which is basically \(LaTeX\) syntax but the backslash <code>\</code> is replaced by the hash <code>#</code>. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<!-- <hr class="footer"/><address class="footer"><small> -->
<!-- Generated on Tue May 8 2018 13:18:41 for BAT manual by &#160;<a href="http://www.doxygen.org/index.html"> -->
<!-- <img class="footer" src="doxygen.png" alt="doxygen"/> -->
<!-- </a> 1.8.11 -->
<!-- </small></address> -->
</body>
</html>
